\NeedsTeXFormat{LaTeX2e}[2010/01/01]
\ProvidesPackage{tcardz}[2019/06/07]

% Load needed packages
\RequirePackage{tikz}


% Define main tcard environment
\newenvironment{tcard}[1]{%
	% Check that this card style has been defined
	% Store tcard name
	\newcommand\thistcard{#1}%
	% Define tcard environment functions
	\newcommand\newtcardvar[2]{%
		\expandafter\newcommand\csname ##1\endcsname[1]%
			{\expandafter\renewcommand\csname the##1\endcsname{####1}}%
		\expandafter\newcommand\csname the##1\endcsname{##2}}%
	%
	% Begin tikz drawing
	\begin{tikzpicture}[x=1in,y=1in,every node/.style={inner sep=0,outer sep=0}]%
	% Load card initialization
	\inittcard{\thistcard}%
}{%
	\printtcard{\thistcard}%
	\end{tikzpicture}%
}% Finish defining tcard environment


% Define command to create a new card template
\newcommand\newtcard[3]{%
	\expandafter\newcommand\csname tcardinit#1\endcsname{#2}%
	\expandafter\newcommand\csname tcarddisp#1\endcsname{#3}%
}%

% Define command to create a new card template based on an existing template
\newcommand\expandtcard[4]%
	{\expandafter\newcommand\csname tcardinit#1\endcsname{\inittcard{#2}#3}%
	\expandafter\newcommand\csname tcarddisp#1\endcsname{\printtcard{#2}#4}%
}%

% Commands to use those card templates
\newcommand\inittcard[1]{\csname tcardinit#1\endcsname}%
\newcommand\printtcard[1]{\csname tcarddisp#1\endcsname}%

\endinput
